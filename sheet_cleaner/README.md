# Sheets cleanup scripts

This directory contains scripts that go over the google sheets and produces a merged csv file with all the data and post-processing information like geocode included.

## Contributions to the spreadsheets

Standard Operating Procedures are described in the `SOP.md` file in this directory.

## Generating CSV line list

### One-time setup.

Go to the [cloud console](http://console.developers.google.com/iam-admin/serviceaccounts/details/101380493036790386317;edit=true?previousPage=%2Fapis%2Fcredentials%3Fproject%3Dvoltaic-circuit-274214&project=voltaic-circuit-274214) and getclick on `CREATE KEY`, store the json file on your computer and point the `CREDENTIALS` paths in the config file to this file.

Point the various other config options to appropriate local directories (GIT repo, etc).

### Running the script

To run the script, simply do:

```console
python3 main.py -c CONFIG
```

If you want to push to the repo you specified in the config file, add  `--push_to_git` to the command line above.

## Geocoding

Geocoding is documented in its own sub-directory, please refer to it directly.

## Creating a new sheet

A single sheet can contain 5M cells max, we currently use 24 columns which means we can go up to 208K rows per sheet.

It is safer to start a new sheet whenever the number of rows reaches 150K or so, if only to keep the sheet editing snappy.

Logs generated by the main script will contain warnings if a sheet goes over 150K rows.

To generate a new sheet from a [template](https://docs.google.com/spreadsheets/d/1-WgQiP0Bed7om1dYdfFZhZ5Nx70WnNoB7mtIBSK3z4k/edit#gid=0) run:

```console
python3 create_sheet.py -c CONFIG -n "new sheet name" -w "worksheet name"
```